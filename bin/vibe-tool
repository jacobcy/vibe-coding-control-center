#!/usr/bin/env zsh
# vibe-tool - Tool management command
# Usage: vibe tool <command> [args]

set -e

# Resolve script directory
_vibe_tool_script="${0:A}"
_vibe_tool_root="$(cd "$(dirname "$_vibe_tool_script")/.." && pwd)"

# Source dependencies
source "${_vibe_tool_root}/lib/config.sh"
source "${_vibe_tool_root}/lib/tool_manager.sh"

# Parse subcommand
subcmd="${1:-}"
shift || true

case "$subcmd" in
    list|ls)
        vibe_tool_list
        ;;
    install)
        vibe_tool_install "$@"
        ;;
    uninstall|remove|rm)
        vibe_tool_uninstall "$@"
        ;;
    enable|on)
        vibe_tool_enable "$@"
        ;;
    disable|off)
        vibe_tool_disable "$@"
        ;;
    default)
        vibe_tool_default "$@"
        ;;
    status)
        vibe_tool_status "$@"
        ;;
    -h|--help|help)
        cat << 'EOF'
vibe tool - Manage AI tools

Usage:
  vibe tool <command> [arguments]

Commands:
  list              List all tools
  install <name>    Install a tool
  uninstall <name>  Uninstall a tool
  enable <name>     Enable a tool
  disable <name>    Disable a tool
  default <name>    Set default tool
  status [name]     Show tool status

Known Tools:
  claude    Claude Code - Anthropic's AI coding assistant
  opencode  OpenCode - Open source AI coding assistant
  codex     Codex - OpenAI's coding model

Examples:
  vibe tool list
  vibe tool install claude
  vibe tool enable claude
  vibe tool default claude
  vibe tool status

Tools are stored in: ~/.vibe/tools/<name>/
Each tool has:
  - config.yaml: Tool configuration
  - mcp.yaml: MCP server configuration
  - enabled: Marker file (created when enabled)
EOF
        ;;
    "")
        # No subcommand - show status
        vibe_tool_status
        echo ""
        echo "Run 'vibe tool --help' for more commands."
        ;;
    *)
        echo "Unknown command: $subcmd" >&2
        echo "Run 'vibe tool --help' for usage" >&2
        exit 1
        ;;
esac
